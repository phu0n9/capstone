{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nimport { useAuth0 } from '@auth0/auth0-react';\n\nrequire('dotenv').config();\n\nexport default function InfinityScroll(pageNumber, keyword, selection) {\n  _s();\n\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [inventory, setInventory] = useState([]);\n  const [hasMore, setHasMore] = useState(false);\n  const [change, setChange] = useState(false);\n  const heroku = 'https://schaeffler.herokuapp.com/';\n  const {\n    isAuthenticated,\n    getAccessTokenSilently\n  } = useAuth0(); // 'http://localhost:5000/inventory'\n\n  useEffect(() => {\n    const pusher = new Pusher(process.env.REACT_APP_PUSHER_KEY, {\n      'cluster': process.env.REACT_APP_PUSHER_CLUSTER,\n      forceTLS: true\n    });\n    const channel = pusher.subscribe('tasks');\n    channel.bind('inserted', function () {\n      console.log(\"updated\");\n      fetchApi('http://localhost:5000/inventory', {\n        page: 5\n      });\n      setChange(true);\n    });\n    return () => channel.unbind('inserted');\n  }, [isAuthenticated, getAccessTokenSilently]);\n  useEffect(() => {\n    if (keyword !== undefined) {\n      switch (selection) {\n        case \"location\":\n          fetchApi('http://localhost:5000/sort/sortByLocation', {\n            location: keyword\n          });\n          break;\n\n        case \"userId\":\n          fetchApi('http://localhost:5000/sort/sortByUserId', {\n            userId: keyword\n          });\n          break;\n\n        case \"date\":\n          fetchApi('http://localhost:5000/sort/sortByTime', {\n            time: keyword\n          });\n          break;\n\n        default:\n          break;\n      }\n    }\n  }, [keyword, selection]);\n  useEffect(() => {\n    setLoading(true);\n    setError(false);\n\n    if (keyword === '') {\n      axios({\n        method: 'GET',\n        url: 'http://localhost:5000/inventory',\n        params: {\n          page: pageNumber\n        }\n      }).then(res => {\n        setInventory(prevInventory => {\n          return [...new Set([...prevInventory, ...res.data.map(i => i)])];\n        });\n        setHasMore(res.data.length > 0);\n        setLoading(false);\n        setChange(false);\n      }).catch(e => {\n        setError(true);\n        console.log('Error: ' + e);\n      });\n    }\n  }, [pageNumber, keyword]);\n  return {\n    loading,\n    hasMore,\n    error,\n    inventory,\n    change\n  };\n}\n\n_s(InfinityScroll, \"LH9hs0JZ1wMZaQOntM9XoG7bbyY=\", false, function () {\n  return [useAuth0];\n});\n\n_c = InfinityScroll;\n\nvar _c;\n\n$RefreshReg$(_c, \"InfinityScroll\");","map":{"version":3,"sources":["C:/Users/Admin/Downloads/capstone/schaeffler/client/src/InfinityScroll.js"],"names":["useEffect","useState","axios","Pusher","useAuth0","require","config","InfinityScroll","pageNumber","keyword","selection","loading","setLoading","error","setError","inventory","setInventory","hasMore","setHasMore","change","setChange","heroku","isAuthenticated","getAccessTokenSilently","pusher","process","env","REACT_APP_PUSHER_KEY","REACT_APP_PUSHER_CLUSTER","forceTLS","channel","subscribe","bind","console","log","fetchApi","page","unbind","undefined","location","userId","time","method","url","params","then","res","prevInventory","Set","data","map","i","length","catch","e"],"mappings":"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","sourcesContent":["import {useEffect,useState} from 'react'\r\nimport axios from 'axios'\r\nimport Pusher from 'pusher-js'\r\nimport {useAuth0} from '@auth0/auth0-react'\r\nrequire('dotenv').config()\r\n\r\nexport default function InfinityScroll(pageNumber,keyword,selection) {\r\n    const [loading,setLoading] = useState(true)\r\n    const [error,setError] = useState(false)\r\n    const [inventory,setInventory] = useState([])\r\n    const [hasMore,setHasMore] = useState(false)       \r\n    const [change,setChange] = useState(false)\r\n    const heroku = 'https://schaeffler.herokuapp.com/'\r\n    const {isAuthenticated,getAccessTokenSilently} = useAuth0()\r\n\r\n   \r\n    // 'http://localhost:5000/inventory'\r\n    useEffect(() =>{\r\n        \r\n        const pusher = new Pusher(process.env.REACT_APP_PUSHER_KEY,{\r\n            'cluster':process.env.REACT_APP_PUSHER_CLUSTER,\r\n            forceTLS: true,\r\n        })\r\n        const channel = pusher.subscribe('tasks')\r\n        channel.bind('inserted',function(){\r\n            console.log(\"updated\")\r\n            fetchApi('http://localhost:5000/inventory',{page:5})\r\n            setChange(true)\r\n        })\r\n        return () => channel.unbind('inserted')\r\n    },[isAuthenticated,getAccessTokenSilently])\r\n\r\n\r\n    useEffect(() =>{\r\n        if(keyword !== undefined){\r\n            switch(selection){\r\n                case \"location\":\r\n                    fetchApi('http://localhost:5000/sort/sortByLocation',{location:keyword})\r\n                    break\r\n                case \"userId\":\r\n                    fetchApi('http://localhost:5000/sort/sortByUserId',{userId:keyword})\r\n                    break\r\n                case \"date\":\r\n                    fetchApi('http://localhost:5000/sort/sortByTime',{time:keyword})\r\n                    break\r\n                default:\r\n                    break\r\n            }\r\n        }\r\n    },[keyword,selection])\r\n\r\n    useEffect(() =>{\r\n        setLoading(true)\r\n        setError(false)\r\n        if(keyword === ''){\r\n            axios({\r\n                method:'GET',\r\n                url: 'http://localhost:5000/inventory',\r\n                params:{page:pageNumber}\r\n            })\r\n            .then(res => {\r\n                setInventory(prevInventory =>{\r\n                    return [...new Set([...prevInventory,...res.data.map(i => i)])]\r\n                })\r\n                    setHasMore(res.data.length > 0)\r\n                    setLoading(false)\r\n                    setChange(false)\r\n            })\r\n            .catch(e =>{\r\n                setError(true)\r\n                console.log('Error: '+e)\r\n            })\r\n        }\r\n    },[pageNumber,keyword])\r\n\r\n    return {loading,hasMore,error,inventory,change}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}