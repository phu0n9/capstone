{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nexport default function InfinityScroll(pageNumber, keyword, selection) {\n  _s();\n\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [inventory, setInventory] = useState([]);\n  const [hasMore, setHasMore] = useState(false);\n  const heroku = 'https://schaeffler.herokuapp.com/inventory';\n\n  function fetchApi(URL, paramsDict) {\n    axios({\n      method: 'GET',\n      url: URL,\n      params: paramsDict\n    }).then(res => {\n      setInventory(() => {\n        return [...new Set([...'', ...res.data.map(i => i)])];\n      }); // setHasMore(res.data.length > 0)\n      // setLoading(false)\n    }).catch(e => {\n      setError(true);\n      console.log('Error: ' + e);\n    });\n  } // 'http://localhost:5000/inventory'\n\n\n  useEffect(() => {\n    const pusher = new Pusher('2ccb32686bdc0f96f50a', {\n      'cluster': 'ap1',\n      encrypted: true\n    });\n    const channel = pusher.subscribe('tasks');\n    channel.bind('inserted', function () {\n      fetchApi('http://localhost:5000/inventory', {\n        page: 5\n      });\n    });\n    return () => channel.unbind('inserted');\n  }, [keyword]);\n  useEffect(() => {\n    if (keyword !== undefined) {\n      switch (selection) {\n        case \"location\":\n          fetchApi('http://localhost:5000/sort', {\n            location: keyword\n          });\n          break;\n\n        case \"userId\":\n          fetchApi('http://localhost:5000/sort', {\n            userId: keyword\n          });\n          break;\n\n        case \"date\":\n          fetchApi('http://localhost:5000/sort', {\n            time: keyword\n          });\n          break;\n\n        default:\n          fetchApi('http://localhost:5000/inventory', {\n            location: keyword\n          });\n          break;\n      }\n    }\n  }, [keyword, selection]);\n\n  function getApi(URL, paramsDict) {\n    setLoading(true);\n    setError(false);\n\n    if (keyword === undefined) {\n      axios({\n        method: 'GET',\n        url: URL,\n        params: paramsDict\n      }).then(res => {\n        setInventory(prevInventory => {\n          return [...new Set([...prevInventory, ...res.data.map(i => i)])];\n        });\n        setHasMore(res.data.length > 0);\n        setLoading(false);\n      }).catch(e => {\n        setError(true);\n        console.log('Error: ' + e);\n      });\n    }\n  }\n\n  useEffect(() => {\n    getApi('http://localhost:5000/inventory', {\n      page: pageNumber\n    });\n  }, [pageNumber, keyword]);\n  return {\n    loading,\n    hasMore,\n    error,\n    inventory\n  };\n}\n\n_s(InfinityScroll, \"B1Unve+0qCvDoEJdtGwBmbg97hw=\");\n\n_c = InfinityScroll;\n\nvar _c;\n\n$RefreshReg$(_c, \"InfinityScroll\");","map":{"version":3,"sources":["C:/Users/Admin/Downloads/capstone/schaeffler/client/src/InfinityScroll.js"],"names":["useEffect","useState","axios","Pusher","InfinityScroll","pageNumber","keyword","selection","loading","setLoading","error","setError","inventory","setInventory","hasMore","setHasMore","heroku","fetchApi","URL","paramsDict","method","url","params","then","res","Set","data","map","i","catch","e","console","log","pusher","encrypted","channel","subscribe","bind","page","unbind","undefined","location","userId","time","getApi","prevInventory","length"],"mappings":"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","sourcesContent":["import {useEffect,useState} from 'react'\r\nimport axios from 'axios'\r\nimport Pusher from 'pusher-js'\r\n\r\nexport default function InfinityScroll(pageNumber,keyword,selection) {\r\n    const [loading,setLoading] = useState(true)\r\n    const [error,setError] = useState(false)\r\n    const [inventory,setInventory] = useState([])\r\n    const [hasMore,setHasMore] = useState(false)       \r\n    const heroku = 'https://schaeffler.herokuapp.com/inventory'\r\n\r\n    function fetchApi(URL,paramsDict){\r\n        axios({\r\n            method:'GET',\r\n            url: URL,\r\n            params:paramsDict\r\n        })\r\n        .then(res => {\r\n            setInventory(() =>{\r\n                return [...new Set([...'',...res.data.map(i => i)])]\r\n            })\r\n            // setHasMore(res.data.length > 0)\r\n            // setLoading(false)\r\n        })\r\n        .catch(e =>{\r\n            setError(true)\r\n            console.log('Error: '+e)\r\n        })\r\n    }\r\n    \r\n    // 'http://localhost:5000/inventory'\r\n    useEffect(() =>{\r\n        const pusher = new Pusher('2ccb32686bdc0f96f50a',{\r\n            'cluster':'ap1',\r\n            encrypted:true\r\n        })\r\n        const channel = pusher.subscribe('tasks')\r\n        channel.bind('inserted',function(){\r\n            fetchApi('http://localhost:5000/inventory',{page:5})\r\n        })\r\n        return () => channel.unbind('inserted')\r\n    },[keyword])\r\n\r\n\r\n    useEffect(() =>{\r\n        if(keyword !== undefined){\r\n            switch(selection){\r\n                case \"location\":\r\n                    fetchApi('http://localhost:5000/sort',{location:keyword})\r\n                    break\r\n                case \"userId\":\r\n                    fetchApi('http://localhost:5000/sort',{userId:keyword})\r\n                    break\r\n                case \"date\":\r\n                    fetchApi('http://localhost:5000/sort',{time:keyword})\r\n                    break\r\n                default:\r\n                    fetchApi('http://localhost:5000/inventory',{location:keyword})\r\n                    break\r\n            }\r\n        }\r\n    },[keyword,selection])\r\n\r\n    function getApi(URL,paramsDict){\r\n        setLoading(true)\r\n        setError(false)\r\n        if(keyword === undefined){\r\n            axios({\r\n                method:'GET',\r\n                url: URL,\r\n                params:paramsDict\r\n            })\r\n            .then(res => {\r\n                setInventory(prevInventory =>{\r\n                    return [...new Set([...prevInventory,...res.data.map(i => i)])]\r\n                })\r\n                    setHasMore(res.data.length > 0)\r\n                    setLoading(false)\r\n            })\r\n            .catch(e =>{\r\n                setError(true)\r\n                console.log('Error: '+e)\r\n            })\r\n        }\r\n    }\r\n\r\n    useEffect(() =>{\r\n        getApi('http://localhost:5000/inventory',{page:pageNumber})\r\n    },[pageNumber,keyword])\r\n\r\n    return {loading,hasMore,error,inventory}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}