{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nimport { useAuth0 } from '@auth0/auth0-react';\n\nrequire('dotenv').config();\n\nexport default function PopUp() {\n  _s();\n\n  const [queue, setQueue] = useState([]);\n  const [error, setError] = useState(false);\n  const [landingStatus, setLandingStatus] = useState(\"up\");\n  const [searchStatus, setSearchStatus] = useState(\"available\");\n  const heroku = 'https://schaeffler.herokuapp.com/queue';\n  const {\n    isAuthenticated,\n    getAccessTokenSilently\n  } = useAuth0(); // 'http://localhost:5000/queue'\n\n  useEffect(() => {}, [getAccessTokenSilently, isAuthenticated]);\n\n  function fetchChanges() {\n    setError(false);\n    axios({\n      method: 'GET',\n      url: heroku\n    }).then(res => {\n      setQueue(() => {\n        return [...new Set([...'', ...res.data.map(i => i)])];\n      });\n    }).catch(e => {\n      setError(true);\n      console.log('Error: ' + e);\n    });\n  }\n\n  useEffect(() => {\n    const pusher = new Pusher(process.env.REACT_APP_PUSHER_KEY, {\n      'cluster': process.env.REACT_APP_PUSHER_CLUSTER,\n      forceTLS: true\n    });\n    const channelTask = pusher.subscribe('tasks');\n    channelTask.bind('deleted', function () {\n      fetchChanges();\n    });\n    channelTask.bind('inserted', function () {\n      fetchChanges();\n    });\n    const channelLanding = pusher.subscribe('armarker');\n    channelLanding.bind('land', function (data) {\n      setLandingStatus(data.landingStatus);\n    });\n    const channelSearch = pusher.subscribe('search');\n    channelSearch.bind('keyword', function (data) {\n      if (data !== \"\") {\n        setSearchStatus(\"searching\");\n      } else setSearchStatus(\"done\");\n    });\n    return () => {\n      channelTask.unbind();\n      channelLanding.unbind();\n      channelSearch.unbind();\n    };\n  }, []);\n  return {\n    queue,\n    error,\n    landingStatus,\n    searchStatus\n  };\n}\n\n_s(PopUp, \"NgRkHf34tVhFU5TrQ7gEfy7FhVU=\", false, function () {\n  return [useAuth0];\n});\n\n_c = PopUp;\n\nvar _c;\n\n$RefreshReg$(_c, \"PopUp\");","map":{"version":3,"sources":["C:/Users/Admin/Downloads/capstone/schaeffler/client/src/PopUp.js"],"names":["useState","useEffect","axios","Pusher","useAuth0","require","config","PopUp","queue","setQueue","error","setError","landingStatus","setLandingStatus","searchStatus","setSearchStatus","heroku","isAuthenticated","getAccessTokenSilently","fetchChanges","method","url","then","res","Set","data","map","i","catch","e","console","log","pusher","process","env","REACT_APP_PUSHER_KEY","REACT_APP_PUSHER_CLUSTER","forceTLS","channelTask","subscribe","bind","channelLanding","channelSearch","unbind"],"mappings":"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","sourcesContent":["import {useState,useEffect} from 'react'\r\nimport axios from 'axios'\r\nimport Pusher from 'pusher-js'\r\nimport {useAuth0} from '@auth0/auth0-react'\r\n\r\nrequire('dotenv').config()\r\n\r\nexport default function PopUp() {\r\n\r\n    const [queue,setQueue] = useState([])\r\n    const [error,setError] = useState(false)\r\n    const [landingStatus,setLandingStatus] = useState(\"up\")\r\n    const [searchStatus, setSearchStatus] = useState(\"available\")\r\n    const heroku = 'https://schaeffler.herokuapp.com/queue'\r\n    const {isAuthenticated,getAccessTokenSilently} = useAuth0()\r\n    \r\n    // 'http://localhost:5000/queue'\r\n    \r\n    useEffect(() =>{\r\n\r\n    },[getAccessTokenSilently,isAuthenticated])\r\n\r\n    function fetchChanges(){\r\n        setError(false)\r\n            axios({\r\n                method:'GET',\r\n                url: heroku,\r\n            })\r\n            .then(res => {\r\n                setQueue(() =>{\r\n                    return [...new Set([...'',...res.data.map(i => i)])]\r\n                })\r\n            })\r\n            .catch(e =>{\r\n                setError(true)\r\n                console.log('Error: '+e)\r\n            })\r\n    }\r\n\r\n    useEffect(() =>{\r\n        const pusher = new Pusher(process.env.REACT_APP_PUSHER_KEY,{\r\n            'cluster':process.env.REACT_APP_PUSHER_CLUSTER,\r\n            forceTLS: true,\r\n        })\r\n        const channelTask = pusher.subscribe('tasks')\r\n        channelTask.bind('deleted',function(){\r\n            fetchChanges()\r\n        })\r\n        channelTask.bind('inserted',function(){\r\n            fetchChanges()\r\n        })\r\n        const channelLanding = pusher.subscribe('armarker')\r\n        channelLanding.bind('land',function(data){\r\n            setLandingStatus(data.landingStatus)\r\n        })\r\n        const channelSearch = pusher.subscribe('search')\r\n        channelSearch.bind('keyword',function(data){\r\n            if (data !== \"\"){\r\n                setSearchStatus(\"searching\")\r\n            }\r\n            else setSearchStatus(\"done\")\r\n        })\r\n        return () => {\r\n            channelTask.unbind()\r\n            channelLanding.unbind()\r\n            channelSearch.unbind()\r\n        }\r\n    },[])\r\n\r\n    return {queue,error,landingStatus,searchStatus}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}